
[{{- range $index, $page := .Site.Pages -}}
  {{- if ne $page.Type "json" -}}
  [{{- range $index, $page := .Site.Pages -}}
    {{- if ne $page.Type "json" -}}
        {{- range $index, $html :=  findRE "<ul(.|\n)*?</ul>" $page.Content -}}  
          {{ $content := . | plainify }}
          {      
            "objectID": "{{ md5 . }}",
            "url": "{{ $page.Permalink }}",
            "title": "{{ htmlEscape $page.Title}}",
            "content": {{ $content | jsonify }},
            "hierarchy": { 
              "lvl0": "{{ htmlEscape $page.Parent.Title }}",
              "lvl1": "{{ htmlEscape $page.Title}}",
              "lvl2": "",
              "lvl3": "",
              "lvl4": "",
              "lvl5": "",
              "lvl6": ""
            }
          },   
        {{- end -}}
        {{- range $index, $html :=  findRE "<table(.|\n)*?</table>" $page.Content -}}        
          {{ $content := . | plainify }}
          {      
            "objectID": "{{ md5 . }}",
            "url": "{{ $page.Permalink }}",
            "title": "{{ htmlEscape $page.Title}}",
            "content": {{ $content | jsonify }},
            "hierarchy": { 
              "lvl0": "{{ htmlEscape $page.Parent.Title }}",
              "lvl1": "{{ htmlEscape $page.Title}}",
              "lvl2": "",
              "lvl3": "",
              "lvl4": "",
              "lvl5": "",
              "lvl6": ""
            }
          },  
        {{- end -}}
        {{- range $index, $html :=  findRE "<p(.|\n)*?</p>" $page.Content -}}        
          {{ $content := . | plainify }}
          {      
            "objectID": "{{ md5 . }}",
            "url": "{{ $page.Permalink }}",
            "title": "{{ htmlEscape $page.Title}}",
            "content": {{ $content | jsonify }},
            "hierarchy": { 
              "lvl0": "{{ htmlEscape $page.Parent.Title }}",
              "lvl1": "{{ htmlEscape $page.Title}}",
              "lvl2": "",
              "lvl3": "",
              "lvl4": "",
              "lvl5": "",
              "lvl6": ""
            }
          },  
        {{- end -}}
        {{- range $index, $html :=  findRE "<h2(.|\n)*?</h2>" $page.Content -}}  
          {{- $html_id := findRE "id=(.|\n)*?>" . -}} 
          {{ $html_id_f := delimit $html_id "" ""}}
          {{ $html_id_f := substr html_id_f 4 -2 }}
          {{ $content := . | plainify }}
          {      
            "objectID": "{{ md5 . }}",
            "url": "{{ $page.Permalink }}#{{ $html_id_f }}",
            "title": "{{ htmlEscape $page.Title}}",
            "content": {{ $content | jsonify }},
            "hierarchy": { 
              "lvl0": "{{ htmlEscape $page.Parent.Title }}",
              "lvl1": "{{ htmlEscape $page.Title}}",
              "lvl2": {{ $content | jsonify }},
              "lvl3": "",
              "lvl4": "",
              "lvl5": "",
              "lvl6": ""
            }
          },    
        {{- end -}}
    {{- end -}}
  {{- end -}}
    {
      "objectID": "{{ md5 "null" }}",
      "url": "",
      "title": "null",
      "content": "null",
      "hierarchy": { 
        "lvl0": "null",
        "lvl1": "",
        "lvl2": "",
        "lvl3": "",
        "lvl4": "",
        "lvl5": "",
        "lvl6": ""
      }
    }
  ]
  
  
  
  {{- end -}}
{{- end -}}
  {
    "objectID": "{{ md5 "null" }}",
    "url": "",
    "title": "null",
    "content": "null",
    "hierarchy": { 
      "lvl0": "null",
      "lvl1": "",
      "lvl2": "",
      "lvl3": "",
      "lvl4": "",
      "lvl5": "",
      "lvl6": ""
    }
  }
]


