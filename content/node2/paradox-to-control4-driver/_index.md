---
weight: 40
title : "枫叶驱动(对接Control4)使用说明"
---

**目录**

- [简介](#j20)
- [注意事项](#j10)
- [功能](#j30)
- [下载和授权](#j35)
- [版本更新日志](#j40)
- [准备工作](#j50)
  - [硬件](#j51)
  - [软件](#j52)
- [驱动设置](#j70)
  - [驱动设置-防区如何自动分配至所在分区](#j71)
  - [驱动设置-如何利用探测器信号联动其他设备](#j72)
  - [驱动设置-智能按钮如何使用](#j73)
- [常见问题](#j80)
  - [驱动和安防系统无法通讯](#j81)
  - [键盘分区锁定](#j82)
- [联系方式](#j90)

<h2 id="j20">简介</h2>

---

[枫叶](http://www.paradox.com)创立于1989年，全球领先的安防系统提供商，业务遍及160多个国家和地区。拥有多项发明专利。连续多年荣获中国十大安防国际品牌等奖项。产品均取得公安部产品检测报告和3C证书。作为行业的领跑者，产品以卓越的品质、功能灵活（模块化设计理念），个性化著称。

为了满足智能家居的个性化需求，整合各系统的资源，更加灵活、智能和人性化。我们提供枫叶和[Control4](http://www.control4.com)集成对接解决方案和驱动。现在功能已经成熟稳定，随着产品和方案的演化会持续升级更新。感谢各位合作伙伴关注和支持。

<h2 id="j10">注意事项</h2>

---

<font color=#DC143C>

更新驱动的方法：

- 记录原来驱动的设置参数；
- 删除原来的驱动；
- 加载新版本驱动；
- 串口建立连接，设置相关的参数。

</font>

<h2 id="j30">功能</h2>

---

- 最大支持8个分区和192个防区；
- 通过Control4执行分区布/撤防、报警状态展示、取消报警等操作；
- 通过Control4执行3种一键紧急报警求救(110,120,119)；
- 通过驱动中的智能按钮联动安防主机的继电器，实现更加个性化的智能体验；
- Control4可实时获取并展示防区开路、闭合或报警状态；
- 支持退出延时；
- 支持防区自定义；
- 分区、防区状态自动和安防主机双向实时同步，不管是重启Control4还是初始化驱动；
- 防区自动分配至所属分区；
- Composer编程：分区状态(布防、撤防、报警和紧急报警)、防区状态可联动其他接入中控的资源；
- Composer编程：其他接入中控的资源可对分区布/撤防、一键紧急报警；

<h2 id="j35">下载和授权</h2>

- 驱动下载 -> [ParadoxDriver.rar](/help/node2/paradox-to-control4-driver/release/ParadoxDriver.rar)。

- 驱动授权，访问 -> [驱动授权](http://support.senboll.com:8888/codepay)，请按页面提示输入真实的信息，提交会生成微信支付二维码，支付成功后，服务器自动发送授权码将到您的邮箱。PRT3序列号在电路板的标签上。中控序列号在驱动的属性界面，如图：

 ![驱动授权](/help/node2/paradox-to-control4-driver/images/diver_active.png)

<h2 id="j40">版本更新日志</h2>

---

- 更新时间：20160327
  - 发布第一个版本；
  - 新增：退出延时；
  - 新增：立即、强制和留守布防类型和撤防。
- 更新时间：20160827
  - 新增：3种紧急报警110，119，120功能；
  - 新增：防区状态文字提示；
  - Bug修复：钥匙开关自动撤防界面不同步撤防状态。
- 更新时间：20160914
  - 新增：安防系统中的用户刷卡输出不同的信号，可用于中控联动。
- 更新时间：20160919
  - 新增：驱动在初始化的时候，主动发起分区状态查询；
- 更新时间：20160921
  - 新增：192个防区状态实时显示功能；
  - 新增：单独实时输出防区状态信号，可以用来联动灯光等用途；
  - 新增：支持防区自动分配到相应的分区。
- 更新时间：20170415
  - 新增：最大支持8个分区和192个防区；
  - 新增：支持在Composer上自定义防区和分区中文标签；
  - Bug修复：分区显示消失问题；
  - 新增：为了提供更好的和有针对性的服务，增加注册码授权机制；
  - 新增：自动更新统分区，防区状态，保持状态实时同步到中控主机。
- 更新时间：20170418
  - 优化：提高串口并发处理数据的能力，增强稳定性；
  - Bug修复：重启中控主机后分区内的防区消失的问题；
- 更新时间：20170426
  - 优化：针对有些操作系统Composer上驱动属性的描述显示问题，修改驱动属性说明为ToolTip方式。
- 更新时间：20170818
  - 优化：去掉EntryDelay属性；
  - 优化：减少全局变量，提高运行效率；
  - 优化：自动同步状态功能和算法，提高可靠性；
  - 新增：增加防区报警后状态保持，直到撤防后恢复，此功能是app无法查看报警记录的替代解决方案；
  - 新增：增加防区报警状态字段；
  - Bug修复：撤防或者取消报警时偶尔不弹出密码输入界面。
  - 新增：增加5个智能按钮，智能按钮对应安防主机里面的功能键，可以根据需要作为触发继电器的条件；
  - 新增：Composer中可以联动一键撤防主机。
- 更新时间：20170823
  - 新增：Composer中增加获取分配防区命令按钮；
  - 新增：Composer中增加全局变量命令按钮。
- 更新时间：20170907
  - Bug修复：Control4主机重启分区的防区列表为空；
  - Bug修复：防区被分配到多个分区(枫叶安防系统规定一个防区只能属于一个分区)；
  - 新增：驱动试用，试用时间延长到300分钟。
- 更新时间：20171016
  - 新增：新增智能按钮事件，当按钮被按下会以Event(事件)方式通知Control4，实现联动功能。
- 更新时间：20180314
  - 退出延时时间上限增加到255秒。
- 更新时间：20180503
  - 新增：门禁状态反馈事件：外出请求成功
  - 新增：门禁状态反馈事件：进入请求失败
  - 新增：门禁状态反馈事件：开门时间超时报警
  - 新增：门禁状态反馈事件：开门时间超时报警后恢复
  - 新增：门禁状态反馈事件：门被强制打开报警
  - 新增：门禁状态反馈事件：门被强制打开报警后恢复
  - 新增：门禁状态反馈事件：某个用户请求进入成功
  - 新增：门禁状态反馈事件：某个用户请求进入失败
- 更新时间：20180615
  - 新增：报警后防区状态是否保持驱动属性可选项。
- 更新时间：20180625
  - Bug修复：在退出延时未结束之前取消布防后分区状态依然显示正在布防。
- 更新时间：20181105
  - 优化：提升用户体验，解决Control4部分主机重启后，防区显示不全的问题。
- 更新时间：20181214
  - Bug修复：强制/留守/立即布防状态同步问题。
- 更新时间：20181227
  - 新增：增加医疗、应急和火灾事件，可用于联动场景。
- 更新时间：20190102
  - 优化：驱动图标（更换为枫叶触摸屏键盘）。
  - 新增：增加电话线故障和恢复事件。
  - 新增：增加交流电故障和恢复事件。
  - 新增：增加AUX输出过载故障和恢复事件。
  - 新增：增加警号输出过载故障和恢复事件。
  - 新增：增加警号未接故障和恢复事件。
  - 新增：增加时钟丢失故障和恢复事件。
- 更新时间：20190603
  - 变更：用于驱动Key属性。
  - 变更：驱动在线帮助链接地址。

<h2 id="j50">准备工作</h2>

---

<h3 id="j51">硬件</h3>

- 枫叶编程模块：307USB(串口)或IP150(网络模块)；
- 安防主机(EVO192/EVOHD)；
- PRT3模块(对接专用模块；支持EVO系列枫叶安防主机)；
- Control4中控主机(带双向通信串口)；
- 串口通讯线，用来连接对接模块和中控主机，有些Control4中控主机带9针串口输出用RS232标准直连串口线连接即可，有些Control4主机串口是3.5mm输出，需要3.5转RS232，如果是自制的线，线序请参考；    
    ***3.5mm转DB9：***
    ![3.5mm转DB9](/help/node2/paradox-to-control4-driver/images/3.5-to-db9.jpg)
    ***标准直连串口线：***
    ![标准直连串口线](/help/node2/paradox-to-control4-driver/images/db9-to-db9.jpg)
- PRT3设置：通过枫叶Babyware软件设置，参照下图，设置完毕后必须重启枫叶主机和模块生效。如图：
    ![PRT3设置](/help/node2/paradox-to-control4-driver/images/prt3_settings.png)

<h3 id="j52">软件</h3>

1. 枫叶编程软件Babyware，请访问 -> [枫叶资料服务器](http://support.senboll.com:8888)，登陆用户名和密码请加微信:**13201640833**询问；
2. 如果是通过307USB编程安防主机请下载307USB驱动，请访问 -> [枫叶资料服务器](http://support.senboll.com:8888)，登陆用户名和密码请加微信:**13201640833**询问；

<h2 id="j70">驱动设置</h2>

---

加载枫叶驱动成功后，请先完成授权步骤。初始化设置请按照下面步骤：

- 连接串口：注意硬件串口和Composer上显示的串口要对应，如果前面的步骤都没有问题，在串口连接后驱动会自动获取安防系统的状态；
- 设置驱动属性，驱动属性中有几个比较重要属性需要设置：
  - **User Code** 用户密码，默认是`1234`，跟Babyware设置选项**用户**中管理员密码对应；
  - **Number of Partitions**分区数量，对应Babyware设置选项**系统选项**→**分区选项**的开启的分区数量，默认是`1`；
  - **Number of Zones**防区数量，对应Babyware设置选项**防区**开启的防区数量；
  - **Exit Delay**退出延时，对应Babyware设置选项**系统选项**→**分区选项**的退出延时；
  - **Keep Open When Zone Alarm**当某个防区发生报警，状态是否需要保持直到系统撤防。

<h3 id="j71">驱动设置-防区如何自动分配至所在分区</h3>

首先解释下什么是分区，就是防区的分组，每一组就是一个分区。布/撤防都是对分区而言，防区是一个基本防护的区域，通俗的理解就是1个探测器就是一个防区。
Control4自动分配防区至所在分区，需在Babyware（枫叶安防系统调试软件）的防区编程时，对每一个防区的标签单独设置，规则是：需要在标签加前缀PX: ，其中P是Partition分区的第一个字母，X表示分区号，如果是1分区就是P1:，2分区是P2:，前缀后面的内容可以自定义，只支持数字和字母。如图：

![防区标签](/help/node2/paradox-to-control4-driver/images/zong_label_setting.png)

<h3 id="j72">驱动设置-如何利用探测器信号联动其他设备</h3>

枫叶EVO192和EVOHD主机，最多可以支持192个防区，所有防区信号都会通过驱动发送到中控。在驱动初始化完毕，默认的防区数量是1，根据主机实际的防区数量，修改驱动防区数量属性即可。要实现这个功能，需要2步：

第一步：创建Contact Switch，数量取决于要联动的探测器数量，以3个防区为例，进入Composer -> Connections，拖动Control Outputs下的防区和Contact Switch建立连接，如图：

![建立防区连接1](/help/node2/paradox-to-control4-driver/images/zone_connect_setting1.gif)

第二步：进入Composer -> Programming，假设当防区1开路使继电器Relay输出开路Open信号，如图：

![建立防区连接2](/help/node2/paradox-to-control4-driver/images/zone_connect_setting2.gif)

<h3 id="j73">驱动设置-智能按钮如何使用</h3>

智能按钮是安防主机里面的多功能键(Utility Key)，因为这个按钮的事件可以触发安防主机继电器(PGM)，众所周知继电器可以实现控制的设备很多，所以命名为智能按钮。
在驱动初始化完毕，Composer上会出现5个智能按钮，但是app界面却不显示，这个时候需要在Room上打开导航栏，将其设置为可见，如图：
![智能按钮显示方法](/help/node2/paradox-to-control4-driver/images/utility_display.gif)

在Babyware上继电器(PGM)编程界面上根据需要编程激活事件和恢复事件，编程方法如图：
![智能按钮编程方法](/help/node2/paradox-to-control4-driver/images/uility_babyware_setting.png)

<h2 id="j80">常见问题</h2>

---

<h3 id="j81">驱动和安防系统无法通讯</h3>

常见有3种可能：

1. 硬件连接问题，一般比较的常见原因是串口线的线序问题。
2. 驱动的设置，加载好驱动后，在Composer上需要将驱动和串口建立连接。
3. PRT3的参数没有设置成功，有时候通过枫叶Babyware软件设置的参数没有发送到PRT3模块里，软件有时候显示有误。为了解决这个问题，建议通过键盘设置参数解决。方法如下：

在触摸屏键盘上操作步骤：**菜单** → **高级设置** → **安装设置** → **系统编程** → 输入`000000` → 输入`4003` → 输入PRT3八位序列号 → 输入`016` → 将1,2,4选项打开，效果如图：

![PRT3通过键盘设置](/help/node2/paradox-to-control4-driver/images/prt3-keypad-setting.png)

<h3 id="j82">键盘分区锁定</h3>

这个问题一般情况是输入的密码错误次数太多导致，如果在5分钟之内输入密码错误5次会导致整个情况发生，每次锁定时间是15分钟。如果默认的布撤防密码被修改，要在驱动属性**User Code**上需要手动设置。

<h3 id="j83">无法通过Control4的面板或App执行常规/立即/留守布防</h3>

关于布防方式的详细描述请看[这里](/help/node1/important-knowledge/#j2022)。

<h2 id="j90">联系方式</h2>

---

请务必先仔细阅读此文档，还有疑问，请联系：张工，电话/微信:13201640833。